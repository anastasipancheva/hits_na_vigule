# TOTP Controller

C++ приложение для управления TOTP секретами с шифрованием и верификацией.

## Возможности

- Создание и управление пользователями
- Сохранение TOTP секретов в зашифрованном виде (AES-GCM)
- Верификация TOTP кодов
- Работа с SQLite базой данных
- CLI интерфейс

## Зависимости

- **SQLite3** - база данных
- **OpenSSL** - шифрование и TOTP
- **CMake** - система сборки
- **C++17** - стандарт языка

## Использование

### Запуск приложения
```bash
./totp_controller
```

### Основные команды

- `create_user <username>` - создать пользователя
- `save_secret <username> <secret>` - сохранить TOTP секрет
- `verify <username> <code>` - проверить TOTP код
- `revoke <username>` - отозвать доступ
- `delete_user <username>` - удалить пользователя
- `show_user <username>` - показать информацию о пользователе
- `generate_totp <secret>` - сгенерировать TOTP код
- `help` - показать справку
- `quit` - выйти

### Пример использования

```bash
> create_user alice
Пользователь 'alice' успешно создан

> save_secret alice JBSWY3DPEHPK3PXP
Секрет для пользователя 'alice' успешно сохранен

> verify alice 123456
✓ Доступ разрешен

> show_user alice
Информация о пользователе:
  ID: 550e8400-e29b-41d4-a716-446655440000
  Имя: alice
  Секрет установлен: Да
  Создан: 2024-01-15T10:30:00Z
```

## Безопасность

- Секреты шифруются с использованием AES-GCM
- Мастер-ключ можно задать через переменную окружения `MASTER_KEY`
- Если ключ не задан, генерируется новый (сохраните его!)
- Associated data включает имя пользователя для дополнительной защиты

## Структура базы данных

Таблица `users`:
- `id` - UUID пользователя
- `username` - имя пользователя (уникальное)
- `totp_secret` - зашифрованный TOTP секрет
- `secret_expires_at` - дата истечения секрета
- `created_at` - дата создания
